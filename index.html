<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackjack Visualizer - Tam Timeline</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .input-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .input-section h2 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }
        
        textarea:focus {
            outline: none;
            border-color: #ffd700;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #FF9800, #F57C00);
        }
        
        .result-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            display: none;
        }
        
        .timeline-container {
            margin: 30px 0;
        }
        
        .timeline-step {
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border-left: 5px solid #ffd700;
            position: relative;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        
        .timeline-step:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .timeline-step::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 30px;
            width: 20px;
            height: 20px;
            background: #ffd700;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255,215,0,0.5);
        }
        
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,215,0,0.3);
        }
        
        .step-title {
            font-size: 1.6rem;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .step-time {
            font-size: 14px;
            color: #ccc;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }
        
        .step-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }
        
        .cards-section, .bets-section, .decision-section {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .section-title {
            font-size: 1.2rem;
            color: #ffd700;
            margin-bottom: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .cards-display {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .card {
            width: 65px;
            height: 90px;
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border: 2px solid #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            position: relative;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: scale(1.1) rotate(3deg);
            z-index: 10;
        }
        
        .card.red {
            color: #d32f2f;
        }
        
        .card.new-card {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255,215,0,0.6);
            animation: cardGlow 2s ease-in-out infinite;
        }
        
        @keyframes cardGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.6); }
            50% { box-shadow: 0 0 30px rgba(255,215,0,0.9); }
        }
        
        .card .suit {
            position: absolute;
            top: 8px;
            left: 8px;
            font-size: 14px;
        }
        
        .card .value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .hand-info {
            text-align: center;
            margin: 20px 0;
        }
        
        .hand-score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            margin: 15px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .hand-status {
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            display: inline-block;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .hand-status.win {
            background: linear-gradient(45deg, #4caf50, #45a049);
            box-shadow: 0 4px 15px rgba(76,175,80,0.3);
        }
        
        .hand-status.lose {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            box-shadow: 0 4px 15px rgba(244,67,54,0.3);
        }
        
        .hand-status.active {
            background: linear-gradient(45deg, #2196f3, #1976d2);
            box-shadow: 0 4px 15px rgba(33,150,243,0.3);
        }
        
        .bet-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 12px 0;
            padding: 15px 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .bet-item:hover {
            background: rgba(0,0,0,0.5);
            transform: translateX(5px);
        }
        
        .bet-name {
            font-weight: bold;
            font-size: 15px;
        }
        
        .bet-amount {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 16px;
        }
        
        .bet-new {
            border: 2px solid #ffd700;
            animation: betHighlight 2s ease-in-out infinite;
        }
        
        @keyframes betHighlight {
            0%, 100% { 
                border-color: #ffd700; 
                background: rgba(0,0,0,0.3);
            }
            50% { 
                border-color: #ffed4e; 
                background: rgba(255,215,0,0.1);
            }
        }
        
        .bet-win {
            color: #4caf50;
        }
        
        .bet-lose {
            color: #f44336;
        }
        
        .decision-details {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .decision-action {
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .decision-explanation {
            font-size: 15px;
            color: #ccc;
            line-height: 1.6;
        }
        
        .side-bet-result {
            margin: 15px 0;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .side-bet-name {
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .side-bet-outcome {
            font-size: 15px;
            font-weight: bold;
        }
        
        .side-bet-cards {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            justify-content: center;
        }
        
        .side-bet-cards .card {
            width: 50px;
            height: 70px;
            font-size: 14px;
        }
        
        .combination-badge {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: bold;
            margin: 8px 0;
            display: inline-block;
            box-shadow: 0 2px 8px rgba(255,215,0,0.3);
        }
        
        .error, .success, .loading {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
        
        .error {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }
        
        .success {
            background: linear-gradient(45deg, #4caf50, #45a049);
            color: white;
        }
        
        .loading {
            background: rgba(0,0,0,0.3);
            text-align: center;
            padding: 40px;
            color: white;
        }
        
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #ffd700;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .summary-section {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 30px;
            margin-top: 40px;
            border: 3px solid rgba(255,215,0,0.5);
            backdrop-filter: blur(10px);
        }
        
        .summary-section h3 {
            color: #ffd700;
            font-size: 2rem;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .summary-item {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .summary-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        
        .summary-label {
            font-size: 15px;
            color: #ccc;
            margin-bottom: 10px;
        }
        
        .summary-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd700;
        }
        
        .timeline-nav {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            background: rgba(0,0,0,0.8);
            border-radius: 25px;
            padding: 15px 10px;
            backdrop-filter: blur(10px);
        }
        
        .nav-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            margin: 8px auto;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-dot.active {
            background: #ffd700;
            transform: scale(1.5);
            box-shadow: 0 0 15px rgba(255,215,0,0.5);
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 10px;
            }
            
            .step-content {
                grid-template-columns: 1fr;
            }
            
            .card {
                width: 50px;
                height: 70px;
                font-size: 14px;
            }
            
            .timeline-nav {
                display: none;
            }
            
            .step-header {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎲 Blackjack Timeline Analyzer</h1>
        <p>Oyunun tüm aşamalarını tek sayfada görüntüleyin</p>
    </div>
    
    <div class="container">
        <div class="input-section">
            <h2>📋 JSON Verinizi Yapıştırın</h2>
            <textarea 
                id="jsonInput" 
                placeholder='{"uuid": "...", "data": {"gameProvider": "evolution", "gameType": "blackjack", ...}}'
            ></textarea>
            <div class="buttons">
                <button class="btn" onclick="analyzeGame()">🎯 Tam Timeline Analizi</button>
                <button class="btn btn-secondary" onclick="loadExample()">📝 Örnek Yükle</button>
                <button class="btn btn-warning" onclick="clearAll()">🗑️ Temizle</button>
            </div>
        </div>
        
        <div class="error" id="errorMessage"></div>
        <div class="success" id="successMessage"></div>
        
        <div class="loading" id="loadingMessage">
            <div class="spinner"></div>
            <p>Tam timeline analizi hazırlanıyor...</p>
        </div>
        
        <div class="result-section" id="resultSection">
            <h2>📊 Komplet Oyun Timeline'ı</h2>
            
            <div class="timeline-container" id="timelineContainer">
                <!-- Timeline adımları buraya gelecek -->
            </div>
            
            <div class="summary-section" id="gameSummary">
                <!-- Oyun özeti buraya gelecek -->
            </div>
        </div>
    </div>
    
    <div class="timeline-nav" id="timelineNav">
        <!-- Navigation dots buraya gelecek -->
    </div>

    <script>
        let gameTimeline = [];

        // Örnek JSON verisi
        const exampleJSON = {
            "uuid": "ee6e8b46-a2b2-48ee-88b1-71931a8fa6cf",
            "timestamp": "2025-07-12T13:49:41.630043767",
            "data": {
                "id": "18516c9cf9d727c96d172296",
                "gameProvider": "evolution",
                "gameSubProvider": "evolution",
                "startedAt": "2025-07-12T06:19:17.819Z",
                "settledAt": "2025-07-12T06:19:54.863Z",
                "status": "Resolved",
                "gameType": "blackjack",
                "table": {
                    "id": "rar7lfdoszipwstj",
                    "name": "GT Blackjack 2"
                },
                "dealer": {
                    "uid": "tts186138_______",
                    "name": "Arnas"
                },
                "currency": "EUR",
                "participants": [{
                    "casinoId": "gtec3cw000000001",
                    "playerId": "12554308",
                    "screenName": "CoseqaeiS",
                    "currency": "TRY",
                    "bets": [
                        {
                            "code": "BJ_213Seat1",
                            "stake": 400,
                            "payout": 0,
                            "placedOn": "2025-07-12T06:19:20.485Z"
                        },
                        {
                            "code": "BJ_PerfectPairSeat1",
                            "stake": 400,
                            "payout": 0,
                            "placedOn": "2025-07-12T06:19:20.485Z"
                        },
                        {
                            "code": "BJ_PlaySeat1",
                            "stake": 5200,
                            "payout": 10400,
                            "placedOn": "2025-07-12T06:19:20.485Z"
                        },
                        {
                            "code": "BJ_DoubleDownSeat1",
                            "stake": 5200,
                            "payout": 10400,
                            "placedOn": "2025-07-12T06:19:32.082Z"
                        }
                    ],
                    "seats": {
                        "Seat1": {
                            "sideBet21p3": {
                                "result": "Lose",
                                "score": 15,
                                "cards": ["4D", "9S", "2H"],
                                "combination": "BJ_NONE"
                            },
                            "sideBetPerfectPair": {
                                "result": "Lose",
                                "score": 11,
                                "cards": ["9S", "2H"],
                                "combination": "BJ_NONE"
                            },
                            "insurance": false,
                            "doubleDown": true,
                            "splitHand": false
                        }
                    }
                }],
                "result": {
                    "dealer": {
                        "score": 23,
                        "cards": ["4D", "AD", "TD", "8C"],
                        "isBlackjack": false
                    },
                    "seats": {
                        "Seat1": {
                            "decisions": [
                                {
                                    "recordedAt": "2025-07-12T06:19:32.238Z",
                                    "type": "DoubleDown"
                                }
                            ],
                            "score": 15,
                            "outcome": "Win",
                            "cards": ["9S", "2H", "4S"]
                        }
                    }
                },
                "wager": 476.43,
                "payout": 884.80
            }
        };

        function showMessage(type, message) {
            const errorEl = document.getElementById('errorMessage');
            const successEl = document.getElementById('successMessage');
            
            errorEl.style.display = 'none';
            successEl.style.display = 'none';
            
            if (type === 'error') {
                errorEl.textContent = message;
                errorEl.style.display = 'block';
            } else {
                successEl.textContent = message;
                successEl.style.display = 'block';
            }
            
            setTimeout(() => {
                errorEl.style.display = 'none';
                successEl.style.display = 'none';
            }, 5000);
        }

        function parseCard(cardCode) {
            const value = cardCode.slice(0, -1);
            const suit = cardCode.slice(-1);
            const suitMap = { 'S': '♠', 'H': '♥', 'D': '♦', 'C': '♣' };
            const isRed = suit === 'H' || suit === 'D';
            return { 
                value: value === 'T' ? '10' : value, 
                suit: suitMap[suit] || '?', 
                isRed,
                code: cardCode
            };
        }

        function calculateHandValue(cards) {
            let value = 0;
            let aces = 0;
            
            cards.forEach(card => {
                const cardValue = card.value;
                if (cardValue === 'A') {
                    aces++;
                    value += 11;
                } else if (['K', 'Q', 'J'].includes(cardValue)) {
                    value += 10;
                } else {
                    value += parseInt(cardValue);
                }
            });
            
            while (value > 21 && aces > 0) {
                value -= 10;
                aces--;
            }
            
            return value;
        }

        function createGameTimeline(data) {
            const timeline = [];
            const participant = data.participants[0];
            const seats = data.result.seats;
            
            // 1. İlk bahisler
            const initialBets = participant.bets.filter(bet => 
                new Date(bet.placedOn).getTime() === new Date(participant.bets[0].placedOn).getTime()
            );
            
            timeline.push({
                step: 1,
                title: "🎯 İlk Bahisler",
                time: participant.bets[0].placedOn,
                type: "initial_bets",
                bets: initialBets,
                description: "Oyuncu başlangıç bahislerini yerleştirdi"
            });

            // 2. İlk kartlar
            Object.entries(seats).forEach(([seatName, seatData]) => {
                if (seatData.cards && seatData.cards.length >= 2) {
                    const initialCards = seatData.cards.slice(0, 2).map(parseCard);
                    timeline.push({
                        step: timeline.length + 1,
                        title: `🃏 ${seatName} - İlk Kartlar`,
                        time: data.startedAt,
                        type: "initial_cards",
                        seat: seatName,
                        cards: initialCards,
                        score: calculateHandValue(initialCards),
                        description: `${seatName} için ilk iki kart dağıtıldı`
                    });
                }
            });

            // 3. Dealer'ın ilk kartı
            if (data.result.dealer.cards && data.result.dealer.cards.length > 0) {
                timeline.push({
                    step: timeline.length + 1,
                    title: "🎩 Dealer'ın Kalan Kartları",
                    time: data.settledAt,
                    type: "dealer_complete",
                    cards: data.result.dealer.cards.map(parseCard),
                    score: data.result.dealer.score,
                    isBust: data.result.dealer.score > 21,
                    description: "Dealer kartlarını tamamladı"
                });
            }

            // 7. Final sonuçlar
            timeline.push({
                step: timeline.length + 1,
                title: "🏆 Final Sonuçlar",
                time: data.settledAt,
                type: "final_results",
                results: seats,
                totalWager: data.wager,
                totalPayout: data.payout,
                netResult: data.payout - data.wager,
                description: "Oyun tamamlandı ve sonuçlar belirlendi"
            });

            return timeline.sort((a, b) => new Date(a.time) - new Date(b.time));
        }

        function getDecisionDescription(decisionType, seatName) {
            const descriptions = {
                "Hit": `${seatName} bir kart daha istedi`,
                "Stand": `${seatName} kartlarında kaldı`,
                "DoubleDown": `${seatName} bahsini ikiye katladı ve son kartını aldı`,
                "Split": `${seatName} elini ikiye böldü`,
                "Insurance": `${seatName} sigorta bahsi yaptı`
            };
            return descriptions[decisionType] || `${seatName} ${decisionType} kararı verdi`;
        }

        function renderCard(card, isNew = false) {
            return `
                <div class="card ${card.isRed ? 'red' : ''} ${isNew ? 'new-card' : ''}">
                    <div class="suit">${card.suit}</div>
                    <div class="value">${card.value}</div>
                </div>
            `;
        }

        function renderBet(bet, isNew = false) {
            const betName = getBetName(bet.code);
            const isWin = bet.payout > bet.stake;
            return `
                <div class="bet-item ${isNew ? 'bet-new' : ''}">
                    <div class="bet-name">${betName}</div>
                    <div class="bet-amount ${isWin ? 'bet-win' : 'bet-lose'}">
                        ${bet.stake} → ${bet.payout} TRY
                    </div>
                </div>
            `;
        }

        function getBetName(betCode) {
            const betNames = {
                'BJ_213Seat1': '21+3 Seat 1',
                'BJ_213Seat2': '21+3 Seat 2',
                'BJ_PerfectPairSeat1': 'Perfect Pair Seat 1',
                'BJ_PerfectPairSeat2': 'Perfect Pair Seat 2',
                'BJ_PlaySeat1': 'Ana Bahis Seat 1',
                'BJ_PlaySeat2': 'Ana Bahis Seat 2',
                'BJ_DoubleDownSeat1': 'Double Down Seat 1',
                'BJ_DoubleDownSeat2': 'Double Down Seat 2',
                'BJ_SplitSeat1': 'Split Seat 1'
            };
            return betNames[betCode] || betCode.replace('BJ_', '').replace('Seat', ' Seat ');
        }

        function getCombinationText(combination) {
            const combinations = {
                'BJ_NONE': 'Kombinasyon Yok',
                'BJ_PAIR': 'Çift (6:1)',
                'BJ_FLUSH': 'Flush (5:1)',
                'BJ_STRAIGHT': 'Straight (10:1)',
                'BJ_THREE_OF_A_KIND': 'Üçlü (30:1)',
                'BJ_STRAIGHT_FLUSH': 'Straight Flush (40:1)',
                'BJ_SUITED_TRIPLE': 'Suited Triple (100:1)'
            };
            return combinations[combination] || combination;
        }

        function renderTimelineStep(stepData, index) {
            const timeStr = new Date(stepData.time).toLocaleTimeString('tr-TR');
            
            let content = '';
            
            switch (stepData.type) {
                case 'initial_bets':
                    content = `
                        <div class="step-content">
                            <div class="bets-section">
                                <div class="section-title">💰 Yerleştirilen Bahisler</div>
                                ${stepData.bets.map(bet => renderBet(bet, true)).join('')}
                                <div style="margin-top: 20px; padding: 15px; background: rgba(255,215,0,0.1); border-radius: 10px; text-align: center;">
                                    <strong style="font-size: 18px;">Toplam Bahis: ${stepData.bets.reduce((sum, bet) => sum + bet.stake, 0)} TRY</strong>
                                </div>
                            </div>
                            <div class="decision-section">
                                <div class="section-title">🎯 Bahis Stratejisi</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        <strong>Oyuncu ${stepData.bets.length} farklı bahis türü seçti:</strong><br><br>
                                        ${stepData.bets.map(bet => `• <strong>${getBetName(bet.code)}</strong>: ${bet.stake} TRY`).join('<br>')}
                                        <br><br>
                                        <em>Bu strateji çeşitli yan bahisler ve ana oyunun kombinasyonunu içeriyor.</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'initial_cards':
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🃏 ${stepData.seat} Kartları</div>
                                <div class="cards-display">
                                    ${stepData.cards.map(card => renderCard(card, true)).join('')}
                                </div>
                                <div class="hand-info">
                                    <div class="hand-score">Skor: ${stepData.score}</div>
                                    <div class="hand-status active">Aktif El</div>
                                </div>
                            </div>
                            <div class="decision-section">
                                <div class="section-title">📊 El Analizi</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        <strong>İlk iki kart:</strong> ${stepData.cards.map(c => c.value + c.suit).join(', ')}<br>
                                        <strong>Toplam değer:</strong> ${stepData.score}<br><br>
                                        ${stepData.score === 21 ? '🎉 <strong>BLACKJACK!</strong> Mükemmel başlangıç!' : 
                                          stepData.score >= 17 ? '🎯 <strong>Güçlü el</strong> - İyi pozisyon' :
                                          stepData.score >= 12 ? '⚖️ <strong>Orta el</strong> - Dikkatli strateji gerekli' : 
                                          '⚠️ <strong>Zayıf el</strong> - Risk alma gerekebilir'}
                                        <br><br>
                                        <em>Dealer'ın açık kartına göre strateji belirlenecek.</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'dealer_first_card':
                    const dealerCard = stepData.cards[0];
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🎩 Dealer'ın Açık Kartı</div>
                                <div class="cards-display">
                                    ${renderCard(dealerCard, true)}
                                    <div class="card" style="background: linear-gradient(145deg, #333, #222); color: #666; border-color: #555;">
                                        <div class="value">?</div>
                                    </div>
                                </div>
                                <div class="hand-info">
                                    <div class="hand-score">Açık Kart: ${dealerCard.value}${dealerCard.suit}</div>
                                </div>
                            </div>
                            <div class="decision-section">
                                <div class="section-title">🎯 Dealer Kartı Analizi</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        <strong>Dealer'ın açık kartı:</strong> ${dealerCard.value}${dealerCard.suit}<br><br>
                                        ${['A', 'K', 'Q', 'J', '10', 'T'].includes(dealerCard.value) ? 
                                          '⚠️ <strong>Güçlü dealer kartı</strong><br>Dealer\'ın güçlü pozisyonu var. Dikkatli oynayın!' :
                                          ['2', '3', '4', '5', '6'].includes(dealerCard.value) ?
                                          '😊 <strong>Zayıf dealer kartı</strong><br>Dealer bust olma ihtimali yüksek. Avantaj sizde!' :
                                          '⚖️ <strong>Orta dealer kartı</strong><br>Dengeli durum. Dikkatli strateji uygulayın!'}
                                        <br><br>
                                        <em>Bu bilgi oyuncu kararlarını etkiler.</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'side_bets':
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🎰 ${stepData.seat} Yan Bahis Sonuçları</div>
                                
                                ${stepData.sideBets.perfectPair ? `
                                    <div class="side-bet-result">
                                        <div class="side-bet-name">Perfect Pair</div>
                                        <div class="side-bet-cards">
                                            ${stepData.sideBets.perfectPair.cards.map(card => renderCard(parseCard(card))).join('')}
                                        </div>
                                        <div class="side-bet-outcome ${stepData.sideBets.perfectPair.result.toLowerCase()}">
                                            <strong>${stepData.sideBets.perfectPair.result === 'Win' ? '🎯 KAZANÇ' : '❌ KAYIP'}</strong>
                                        </div>
                                        <div class="combination-badge">
                                            ${getCombinationText(stepData.sideBets.perfectPair.combination)}
                                        </div>
                                    </div>
                                ` : ''}
                                
                                ${stepData.sideBets.bet21p3 ? `
                                    <div class="side-bet-result">
                                        <div class="side-bet-name">21+3</div>
                                        <div class="side-bet-cards">
                                            ${stepData.sideBets.bet21p3.cards.map(card => renderCard(parseCard(card))).join('')}
                                        </div>
                                        <div class="side-bet-outcome ${stepData.sideBets.bet21p3.result.toLowerCase()}">
                                            <strong>${stepData.sideBets.bet21p3.result === 'Win' ? '🎯 KAZANÇ' : '❌ KAYIP'}</strong>
                                        </div>
                                        <div class="combination-badge">
                                            ${getCombinationText(stepData.sideBets.bet21p3.combination)}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="decision-section">
                                <div class="section-title">📊 Yan Bahis Analizi</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        <strong>Yan bahis değerlendirmesi:</strong><br><br>
                                        ${stepData.sideBets.perfectPair ? 
                                          `Perfect Pair: ${stepData.sideBets.perfectPair.result === 'Win' ? 
                                            '✅ Kazanç - İlk iki kart uygun kombinasyon oluşturdu' : 
                                            '❌ Kayıp - İlk iki kart çift oluşturmadı'}<br>` : ''}
                                        ${stepData.sideBets.bet21p3 ? 
                                          `21+3: ${stepData.sideBets.bet21p3.result === 'Win' ? 
                                            '✅ Kazanç - Özel kombinasyon elde edildi' : 
                                            '❌ Kayıp - Poker kombinasyonu oluşmadı'}<br>` : ''}
                                        <br>
                                        <em>Yan bahisler ana oyundan bağımsız olarak değerlendirilir.</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'player_decision':
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🃏 ${stepData.seat} Kartları</div>
                                <div class="cards-display">
                                    ${stepData.allCards ? stepData.allCards.map((card, idx) => 
                                        renderCard(card, idx === stepData.allCards.length - 1 && stepData.newCard)
                                    ).join('') : ''}
                                </div>
                                <div class="hand-info">
                                    ${stepData.score ? `<div class="hand-score">Skor: ${stepData.score}</div>` : ''}
                                    ${stepData.score > 21 ? '<div class="hand-status lose">💥 BUST!</div>' : 
                                      stepData.score === 21 ? '<div class="hand-status win">🎯 21!</div>' :
                                      '<div class="hand-status active">Devam</div>'}
                                </div>
                            </div>
                            
                            <div class="decision-section">
                                <div class="section-title">🎯 Oyuncu Kararı</div>
                                <div class="decision-details">
                                    <div class="decision-action">${stepData.decision}</div>
                                    <div class="decision-explanation">
                                        <strong>${stepData.description}</strong><br><br>
                                        ${stepData.newCard ? `<strong>Gelen kart:</strong> ${stepData.newCard.value}${stepData.newCard.suit}<br><br>` : ''}
                                        ${getDecisionAnalysis(stepData.decision, stepData.score, stepData.newCard)}
                                    </div>
                                </div>
                            </div>
                            
                            ${stepData.newBet ? `
                                <div class="bets-section">
                                    <div class="section-title">💰 Ek Bahis</div>
                                    ${renderBet(stepData.newBet, true)}
                                    <div style="margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.1); border-radius: 8px;">
                                        <em>Double Down ile bahis miktarı ikiye katlandı.</em>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                    break;

                case 'dealer_complete':
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🎩 Dealer'ın Tüm Kartları</div>
                                <div class="cards-display">
                                    ${stepData.cards.map((card, idx) => renderCard(card, idx > 0)).join('')}
                                </div>
                                <div class="hand-info">
                                    <div class="hand-score">Final Skor: ${stepData.score}</div>
                                    <div class="hand-status ${stepData.isBust ? 'lose' : 'win'}">
                                        ${stepData.isBust ? '💥 DEALER BUST!' : '🎯 DEALER STAND'}
                                    </div>
                                </div>
                            </div>
                            <div class="decision-section">
                                <div class="section-title">📊 Dealer Final Analizi</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        <strong>Dealer'ın tüm kartları:</strong> ${stepData.cards.map(c => c.value + c.suit).join(', ')}<br>
                                        <strong>Final skor:</strong> ${stepData.score}<br><br>
                                        ${stepData.isBust ? 
                                          '🎉 <strong>Dealer bust oldu!</strong><br>21\'i geçti. Tüm aktif eller otomatik kazandı!' : 
                                          '⚖️ <strong>Dealer stand</strong><br>El karşılaştırması yapılacak. Dealer\'ın skoru ' + stepData.score}
                                        <br><br>
                                        <em>Artık final sonuçlar belirlenebilir.</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'final_results':
                    const netProfit = stepData.netResult > 0;
                    const profitPercentage = ((stepData.totalPayout / stepData.totalWager) * 100).toFixed(1);
                    content = `
                        <div class="step-content">
                            <div class="cards-section">
                                <div class="section-title">🏆 Tüm Ellerin Final Sonuçları</div>
                                ${Object.entries(stepData.results).map(([seatName, result]) => `
                                    <div class="side-bet-result">
                                        <div class="side-bet-name">${seatName}</div>
                                        <div class="side-bet-cards">
                                            ${result.cards.map(card => renderCard(parseCard(card))).join('')}
                                        </div>
                                        <div class="side-bet-outcome ${result.outcome.toLowerCase()}">
                                            <strong>Skor: ${result.score}</strong><br>
                                            ${result.outcome === 'Win' ? '🎉 KAZANÇ' : 
                                              result.outcome === 'Lost' ? '❌ KAYIP' :
                                              result.outcome === 'Push' ? '🤝 BERABERE' : result.outcome}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="bets-section">
                                <div class="section-title">💰 Mali Sonuç</div>
                                <div class="bet-item">
                                    <div class="bet-name">Toplam Bahis</div>
                                    <div class="bet-amount">${stepData.totalWager.toFixed(2)} EUR</div>
                                </div>
                                <div class="bet-item">
                                    <div class="bet-name">Toplam Kazanç</div>
                                    <div class="bet-amount bet-win">${stepData.totalPayout.toFixed(2)} EUR</div>
                                </div>
                                <div class="bet-item" style="border-top: 2px solid #ffd700; margin-top: 15px; padding-top: 20px; background: rgba(255,215,0,0.1);">
                                    <div class="bet-name"><strong>Net Sonuç</strong></div>
                                    <div class="bet-amount ${netProfit ? 'bet-win' : 'bet-lose'}" style="font-size: 18px;">
                                        <strong>${netProfit ? '+' : ''}${stepData.netResult.toFixed(2)} EUR</strong>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="decision-section">
                                <div class="section-title">📊 Oyun Özeti</div>
                                <div class="decision-details">
                                    <div class="decision-explanation">
                                        ${netProfit ? 
                                          '🎉 <strong>Tebrikler! Karlı bir oyun oldu.</strong>' : 
                                          '😔 <strong>Bu sefer şans yaver gitmedi.</strong>'}<br><br>
                                        <strong>Kazanç oranı:</strong> ${profitPercentage}%<br>
                                        <strong>Oyun başarısı:</strong> ${getGameSummary(stepData.results)}<br><br>
                                        <em>${getGameAdvice(stepData.results, netProfit)}</em>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }

            return `
                <div class="timeline-step" id="step-${index}">
                    <div class="step-header">
                        <div class="step-title">${stepData.step}. ${stepData.title}</div>
                        <div class="step-time">⏰ ${timeStr}</div>
                    </div>
                    ${content}
                </div>
            `;
        }

        function getDecisionAnalysis(decision, score, newCard) {
            switch (decision) {
                case 'Hit':
                    if (newCard && score > 21) {
                        return '💥 <strong>Maalesef bust oldunuz!</strong><br>Risk aldınız ama bu sefer işe yaramadı.';
                    } else if (newCard && score === 21) {
                        return '🎯 <strong>Mükemmel! 21 yaptınız!</strong><br>İdeal sonuç elde ettiniz.';
                    } else {
                        return '👍 <strong>Ek kart alma kararı</strong><br>Risk almaya devam ediyorsunuz.';
                    }
                case 'Stand':
                    return score >= 17 ? 
                        '🎯 <strong>İyi karar</strong><br>Güvenli skorla durma stratejisi.' : 
                        '⚠️ <strong>Riskli karar</strong><br>Düşük skorla durma - cesur strateji.';
                case 'DoubleDown':
                    if (newCard && score > 21) {
                        return '😔 <strong>Double down sonrası bust</strong><br>Agresif strateji bu sefer işe yaramadı.';
                    } else if (newCard && score === 21) {
                        return '🎉 <strong>Mükemmel double down!</strong><br>İdeal sonuç ve ikiye katlanmış kazanç.';
                    } else {
                        return '💪 <strong>Agresif strateji</strong><br>Bahsi ikiye katlayarak risk aldınız.';
                    }
                case 'Split':
                    return '✂️ <strong>Çift kartları ayırma</strong><br>İki ayrı el oynama stratejisi.';
                default:
                    return `<strong>${decision} kararı alındı</strong><br>Oyun devam ediyor.`;
            }
        }

        function getGameSummary(results) {
            const wins = Object.values(results).filter(r => r.outcome === 'Win').length;
            const total = Object.values(results).length;
            const percentage = ((wins/total)*100).toFixed(0);
            return `${wins}/${total} el kazanıldı (%${percentage} başarı oranı)`;
        }

        function getGameAdvice(results, netProfit) {
            if (netProfit) {
                return 'Başarılı strateji ve biraz şans bir araya geldi. Benzer yaklaşımları kullanmaya devam edebilirsiniz.';
            } else {
                return 'Her oyun öğrenme fırsatıdır. Dealer kartlarına göre strateji geliştirmeyi unutmayın.';
            }
        }

        function createNavigationDots(timeline) {
            const navContainer = document.getElementById('timelineNav');
            navContainer.innerHTML = timeline.map((_, index) => `
                <div class="nav-dot ${index === 0 ? 'active' : ''}" 
                     onclick="scrollToStep(${index})" 
                     title="${timeline[index].title}">
                </div>
            `).join('');
        }

        function scrollToStep(stepIndex) {
            const stepElement = document.getElementById(`step-${stepIndex}`);
            if (stepElement) {
                stepElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Update navigation dots
                document.querySelectorAll('.nav-dot').forEach((dot, index) => {
                    dot.classList.toggle('active', index === stepIndex);
                });
            }
        }

        function renderFullTimeline(timeline) {
            const container = document.getElementById('timelineContainer');
            
            container.innerHTML = timeline.map((step, index) => 
                renderTimelineStep(step, index)
            ).join('');
            
            createNavigationDots(timeline);
            
            // Auto-scroll to active section
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const stepIndex = parseInt(entry.target.id.split('-')[1]);
                        document.querySelectorAll('.nav-dot').forEach((dot, index) => {
                            dot.classList.toggle('active', index === stepIndex);
                        });
                    }
                });
            }, { threshold: 0.5 });
            
            document.querySelectorAll('.timeline-step').forEach(step => {
                observer.observe(step);
            });
        }

        function analyzeGame() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            const loadingEl = document.getElementById('loadingMessage');
            const resultEl = document.getElementById('resultSection');
            
            if (!jsonInput) {
                showMessage('error', 'Lütfen JSON verinizi yapıştırın!');
                return;
            }
            
            loadingEl.style.display = 'block';
            resultEl.style.display = 'none';
            
            setTimeout(() => {
                try {
                    const jsonData = JSON.parse(jsonInput);
                    
                    if (!jsonData.data || !jsonData.data.gameProvider || !jsonData.data.gameType) {
                        throw new Error('Geçersiz JSON formatı');
                    }
                    
                    if (jsonData.data.gameProvider !== 'evolution' || jsonData.data.gameType !== 'blackjack') {
                        throw new Error('Sadece Evolution Gaming Blackjack oyunları desteklenmektedir');
                    }
                    
                    gameTimeline = createGameTimeline(jsonData.data);
                    renderFullTimeline(gameTimeline);
                    
                    loadingEl.style.display = 'none';
                    resultEl.style.display = 'block';
                    
                    resultEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    showMessage('success', '🎉 Tam timeline analizi tamamlandı! Sağdaki navigasyon ile hızlıca gezinebilirsiniz.');
                    
                } catch (error) {
                    loadingEl.style.display = 'none';
                    showMessage('error', `❌ Hata: ${error.message}`);
                }
            }, 2000);
        }

        function loadExample() {
            document.getElementById('jsonInput').value = JSON.stringify(exampleJSON, null, 2);
            showMessage('success', '📝 Örnek JSON yüklendi! "Tam Timeline Analizi" butonuna tıklayın.');
        }

        function clearAll() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('resultSection').style.display = 'none';
            gameTimeline = [];
            showMessage('success', '🗑️ Tüm veriler temizlendi.');
        }

        // Klavye kısayolları
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.key === 'Enter') {
                analyzeGame();
            }
        });

        // Auto-resize textarea
        document.getElementById('jsonInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 400) + 'px';
        });
    </script>
</body>
</html>🎩 Dealer'ın İlk Kartı",
                    time: data.startedAt,
                    type: "dealer_first_card",
                    cards: [parseCard(data.result.dealer.cards[0])],
                    description: "Dealer'ın açık kartı gösterildi"
                });
            }

            // 4. Yan bahis sonuçları
            if (participant.seats) {
                Object.entries(participant.seats).forEach(([seatName, seatInfo]) => {
                    if (seatInfo.sideBet21p3 || seatInfo.sideBetPerfectPair) {
                        timeline.push({
                            step: timeline.length + 1,
                            title: `🎰 ${seatName} - Yan Bahis Sonuçları`,
                            time: data.startedAt,
                            type: "side_bets",
                            seat: seatName,
                            sideBets: {
                                bet21p3: seatInfo.sideBet21p3,
                                perfectPair: seatInfo.sideBetPerfectPair
                            },
                            description: "Yan bahis sonuçları belirlendi"
                        });
                    }
                });
            }

            // 5. Oyuncu kararları ve ek kartlar
            Object.entries(seats).forEach(([seatName, seatData]) => {
                if (seatData.decisions) {
                    seatData.decisions.forEach((decision, index) => {
                        const stepData = {
                            step: timeline.length + 1,
                            title: `🎯 ${seatName} - ${decision.type}`,
                            time: decision.recordedAt,
                            type: "player_decision",
                            seat: seatName,
                            decision: decision.type,
                            description: getDecisionDescription(decision.type, seatName)
                        };

                        // Kart ekleniyorsa
                        if (decision.type === "Hit" || decision.type === "DoubleDown") {
                            const cardIndex = 2 + index;
                            if (seatData.cards[cardIndex]) {
                                stepData.newCard = parseCard(seatData.cards[cardIndex]);
                                stepData.allCards = seatData.cards.slice(0, cardIndex + 1).map(parseCard);
                                stepData.score = calculateHandValue(stepData.allCards);
                            }
                        }

                        // Double Down bahisi
                        if (decision.type === "DoubleDown") {
                            const ddBet = participant.bets.find(bet => 
                                bet.code.includes("DoubleDown") && 
                                bet.code.includes(seatName.replace("Seat", "Seat"))
                            );
                            if (ddBet) {
                                stepData.newBet = ddBet;
                            }
                        }

                        timeline.push(stepData);
                    });
                }
            });

            // 6. Dealer'ın kalan kartları
            if (data.result.dealer.cards.length > 1) {
                timeline.push({
                    step: timeline.length + 1,
                    title: "
